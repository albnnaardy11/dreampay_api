"use strict";(globalThis.webpackChunkdocs_site=globalThis.webpackChunkdocs_site||[]).push([[4884],{81867(e,i,n){n.r(i),n.d(i,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"security","title":"Security Best Practices","description":"Authentication & Authorization","source":"@site/docs/security.md","sourceDirName":".","slug":"/security","permalink":"/dreampay-api/docs/security","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Admin API","permalink":"/dreampay-api/docs/admin"}}');var t=n(74848),l=n(28453);const a={},r="Security Best Practices",c={},d=[{value:"Authentication &amp; Authorization",id:"authentication--authorization",level:2},{value:"Token Management",id:"token-management",level:3},{value:"PIN Security",id:"pin-security",level:3},{value:"Transaction Safety",id:"transaction-safety",level:2},{value:"Database Locking",id:"database-locking",level:3},{value:"Atomic Operations",id:"atomic-operations",level:3},{value:"Rate Limiting",id:"rate-limiting",level:2},{value:"Input Validation",id:"input-validation",level:2},{value:"Always Validate",id:"always-validate",level:3},{value:"Sanitization",id:"sanitization",level:3},{value:"Production Checklist",id:"production-checklist",level:2},{value:"Common Vulnerabilities Addressed",id:"common-vulnerabilities-addressed",level:2},{value:"OWASP API Security Top 10",id:"owasp-api-security-top-10",level:3},{value:"Reporting Security Issues",id:"reporting-security-issues",level:2}];function o(e){const i={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.header,{children:(0,t.jsx)(i.h1,{id:"security-best-practices",children:"Security Best Practices"})}),"\n",(0,t.jsx)(i.h2,{id:"authentication--authorization",children:"Authentication & Authorization"}),"\n",(0,t.jsx)(i.h3,{id:"token-management",children:"Token Management"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Never"})," expose tokens in URLs or logs"]}),"\n",(0,t.jsx)(i.li,{children:"Store tokens securely on client side (encrypted storage)"}),"\n",(0,t.jsx)(i.li,{children:"Implement token rotation for long-lived sessions"}),"\n",(0,t.jsx)(i.li,{children:"Set appropriate token expiration times"}),"\n"]}),"\n",(0,t.jsx)(i.h3,{id:"pin-security",children:"PIN Security"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"PINs are hashed using bcrypt (cost factor 10)"}),"\n",(0,t.jsx)(i.li,{children:"Never log or display PINs in plain text"}),"\n",(0,t.jsx)(i.li,{children:"Implement rate limiting on PIN verification (max 3 attempts)"}),"\n",(0,t.jsx)(i.li,{children:"Consider implementing PIN lockout after failed attempts"}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"transaction-safety",children:"Transaction Safety"}),"\n",(0,t.jsx)(i.h3,{id:"database-locking",children:"Database Locking"}),"\n",(0,t.jsxs)(i.p,{children:["All financial operations use ",(0,t.jsx)(i.code,{children:"lockForUpdate()"})," to prevent race conditions:"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-php",children:"DB::transaction(function () {\n    $user = User::where('id', $userId)->lockForUpdate()->first();\n    // Perform balance operations\n});\n"})}),"\n",(0,t.jsx)(i.h3,{id:"atomic-operations",children:"Atomic Operations"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"All balance modifications happen within database transactions"}),"\n",(0,t.jsx)(i.li,{children:"Failed transactions are automatically rolled back"}),"\n",(0,t.jsx)(i.li,{children:"No partial state changes are possible"}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"rate-limiting",children:"Rate Limiting"}),"\n",(0,t.jsx)(i.p,{children:"Current limits:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Authentication"}),": 10 requests/minute"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Protected Routes"}),": 60 requests/minute"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Merchant Scan"}),": Inherits protected route limit"]}),"\n"]}),"\n",(0,t.jsxs)(i.p,{children:["Customize in ",(0,t.jsx)(i.code,{children:"routes/api.php"}),":"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-php",children:"Route::middleware('throttle:10,1')->post('/login', ...);\n"})}),"\n",(0,t.jsx)(i.h2,{id:"input-validation",children:"Input Validation"}),"\n",(0,t.jsx)(i.h3,{id:"always-validate",children:"Always Validate"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Email format and uniqueness"}),"\n",(0,t.jsx)(i.li,{children:"Amount ranges (min: 1, max: based on business rules)"}),"\n",(0,t.jsx)(i.li,{children:"PIN format (6 digits)"}),"\n",(0,t.jsx)(i.li,{children:"QR code existence"}),"\n"]}),"\n",(0,t.jsx)(i.h3,{id:"sanitization",children:"Sanitization"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Use Laravel's built-in validation"}),"\n",(0,t.jsx)(i.li,{children:"Never trust client input"}),"\n",(0,t.jsx)(i.li,{children:"Validate on both client and server"}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"production-checklist",children:"Production Checklist"}),"\n",(0,t.jsxs)(i.ul,{className:"contains-task-list",children:["\n",(0,t.jsxs)(i.li,{className:"task-list-item",children:[(0,t.jsx)(i.input,{type:"checkbox",disabled:!0})," ","Set ",(0,t.jsx)(i.code,{children:"APP_DEBUG=false"})]}),"\n",(0,t.jsxs)(i.li,{className:"task-list-item",children:[(0,t.jsx)(i.input,{type:"checkbox",disabled:!0})," ","Use HTTPS only"]}),"\n",(0,t.jsxs)(i.li,{className:"task-list-item",children:[(0,t.jsx)(i.input,{type:"checkbox",disabled:!0})," ","Configure CORS properly"]}),"\n",(0,t.jsxs)(i.li,{className:"task-list-item",children:[(0,t.jsx)(i.input,{type:"checkbox",disabled:!0})," ","Enable database query logging for auditing"]}),"\n",(0,t.jsxs)(i.li,{className:"task-list-item",children:[(0,t.jsx)(i.input,{type:"checkbox",disabled:!0})," ","Set up monitoring and alerting"]}),"\n",(0,t.jsxs)(i.li,{className:"task-list-item",children:[(0,t.jsx)(i.input,{type:"checkbox",disabled:!0})," ","Regular security audits"]}),"\n",(0,t.jsxs)(i.li,{className:"task-list-item",children:[(0,t.jsx)(i.input,{type:"checkbox",disabled:!0})," ","Keep dependencies updated"]}),"\n",(0,t.jsxs)(i.li,{className:"task-list-item",children:[(0,t.jsx)(i.input,{type:"checkbox",disabled:!0})," ","Implement backup strategy"]}),"\n",(0,t.jsxs)(i.li,{className:"task-list-item",children:[(0,t.jsx)(i.input,{type:"checkbox",disabled:!0})," ","Use environment-specific credentials"]}),"\n",(0,t.jsxs)(i.li,{className:"task-list-item",children:[(0,t.jsx)(i.input,{type:"checkbox",disabled:!0})," ","Enable Laravel's maintenance mode during deployments"]}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"common-vulnerabilities-addressed",children:"Common Vulnerabilities Addressed"}),"\n",(0,t.jsx)(i.h3,{id:"owasp-api-security-top-10",children:"OWASP API Security Top 10"}),"\n",(0,t.jsxs)(i.ol,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Broken Object Level Authorization"}),": \u2705 Prevented via middleware and ownership checks"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Broken Authentication"}),": \u2705 Sanctum with proper token management"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Excessive Data Exposure"}),": \u2705 Hidden fields in models"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Lack of Resources & Rate Limiting"}),": \u2705 Throttle middleware"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Broken Function Level Authorization"}),": \u2705 Gates for admin/merchant routes"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Mass Assignment"}),": \u2705 Fillable arrays and role protection"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Security Misconfiguration"}),": \u2705 Production-ready defaults"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Injection"}),": \u2705 Eloquent ORM prevents SQL injection"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Improper Assets Management"}),": \u2705 API versioning ready"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Insufficient Logging & Monitoring"}),": \u2705 Laravel logging enabled"]}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"reporting-security-issues",children:"Reporting Security Issues"}),"\n",(0,t.jsxs)(i.p,{children:["If you discover a security vulnerability, please email:\n",(0,t.jsx)(i.strong,{children:(0,t.jsx)(i.a,{href:"mailto:security@dreampay.id",children:"security@dreampay.id"})})]}),"\n",(0,t.jsx)(i.p,{children:"Do not create public GitHub issues for security vulnerabilities."})]})}function h(e={}){const{wrapper:i}={...(0,l.R)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}}}]);