{
    "openapi": "3.0.0",
    "info": {
        "title": "DreamPay API",
        "description": "High-integrity financial API for Santri Market Day ecosystem. Built with Laravel and secured with Sanctum.",
        "contact": {
            "name": "DreamPay Team",
            "email": "admin@dreampay.id"
        },
        "version": "1.0.0"
    },
    "servers": [
        {
            "url": "https://albnnaardy11.github.io/dreampay-api",
            "description": "GitHub Pages Mock Server (Documentation Only)"
        },
        {
            "url": "https://api.dreampay.id/api",
            "description": "Production Server"
        }
    ],
    "paths": {
        "/register": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Register a new Santri account",
                "operationId": "0903f2e0df1a8857bee538fc055417f0",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "name",
                                    "email",
                                    "password"
                                ],
                                "properties": {
                                    "name": {
                                        "type": "string",
                                        "example": "Ahmad Santri"
                                    },
                                    "email": {
                                        "type": "string",
                                        "format": "email",
                                        "example": "ahmad@pondok.com"
                                    },
                                    "password": {
                                        "type": "string",
                                        "format": "password",
                                        "example": "password123"
                                    },
                                    "pin": {
                                        "description": "6-digit transaction PIN",
                                        "type": "string",
                                        "example": "123456"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "User registered successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "User registered successfully"
                                        },
                                        "access_token": {
                                            "type": "string",
                                            "example": "1|qh37J8dJ0lS6..."
                                        },
                                        "token_type": {
                                            "type": "string",
                                            "example": "Bearer"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Validation error"
                    }
                }
            }
        },
        "/login": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Login to get access token",
                "operationId": "2dd578ff7aba2721293dac66833b27d1",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "email",
                                    "password"
                                ],
                                "properties": {
                                    "email": {
                                        "type": "string",
                                        "format": "email"
                                    },
                                    "password": {
                                        "type": "string",
                                        "format": "password"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Login successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "access_token": {
                                            "type": "string",
                                            "example": "1|qh37J8dJ0lS6..."
                                        },
                                        "token_type": {
                                            "type": "string",
                                            "example": "Bearer"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Invalid credentials"
                    }
                }
            }
        },
        "/logout": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Logout and revoke current token",
                "operationId": "68a6108af04af5e3bc1ea68a6c6f1299",
                "responses": {
                    "200": {
                        "description": "Logged out successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Logged out successfully"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/profile": {
            "get": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Get authenticated user profile",
                "operationId": "e92c58f994e8be6e19813ce20425f83e",
                "responses": {
                    "200": {
                        "description": "User profile data",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/User"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/merchant/scan-and-pay": {
            "post": {
                "tags": [
                    "Merchant"
                ],
                "summary": "Merchant scans Santri QR Code to process payment",
                "operationId": "db67b6c34a89c033f589ba1ab5413ce3",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "qr_code",
                                    "amount"
                                ],
                                "properties": {
                                    "qr_code": {
                                        "type": "string",
                                        "example": "DP-ABC123XYZ"
                                    },
                                    "amount": {
                                        "type": "number",
                                        "example": 15000
                                    },
                                    "description": {
                                        "type": "string",
                                        "example": "Beli Nasi Goreng"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Payment successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Payment successful"
                                        },
                                        "merchant_balance": {
                                            "type": "number"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Only merchants can perform this action"
                    },
                    "404": {
                        "description": "Santri not found"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/merchant/products": {
            "get": {
                "tags": [
                    "Merchant"
                ],
                "summary": "List merchant products",
                "operationId": "352bfc8eb33293bee70173611431de40",
                "responses": {
                    "200": {
                        "description": "List of products",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/Product"
                                    }
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            },
            "post": {
                "tags": [
                    "Merchant"
                ],
                "summary": "Add a new product",
                "operationId": "2c96aa2b26d34a7a9eef3084fd964476",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "name",
                                    "price",
                                    "stock"
                                ],
                                "properties": {
                                    "name": {
                                        "type": "string",
                                        "example": "Es Teh"
                                    },
                                    "price": {
                                        "type": "number",
                                        "example": 3000
                                    },
                                    "stock": {
                                        "type": "integer",
                                        "example": 100
                                    },
                                    "description": {
                                        "type": "string",
                                        "example": "Es teh manis segar"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Product added",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Product"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/merchant/sales": {
            "get": {
                "tags": [
                    "Merchant"
                ],
                "summary": "Get merchant sales history",
                "operationId": "cee85910271653119c9c90e195d75533",
                "responses": {
                    "200": {
                        "description": "Sales history",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/Transaction"
                                    }
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/split-bill": {
            "post": {
                "tags": [
                    "Split Bill"
                ],
                "summary": "Create a new Split Bill",
                "operationId": "03ca0bc2ec34442c6e57eedbd65b3144",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "total_amount",
                                    "description",
                                    "participants"
                                ],
                                "properties": {
                                    "total_amount": {
                                        "type": "number",
                                        "example": 60000
                                    },
                                    "description": {
                                        "type": "string",
                                        "example": "Dinner split"
                                    },
                                    "participants": {
                                        "type": "array",
                                        "items": {
                                            "properties": {
                                                "user_id": {
                                                    "type": "integer",
                                                    "example": 2
                                                },
                                                "amount": {
                                                    "type": "number",
                                                    "example": 30000
                                                }
                                            },
                                            "type": "object"
                                        }
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Split Bill created successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Split Bill created successfully"
                                        },
                                        "split_bill": {
                                            "$ref": "#/components/schemas/SplitBill"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/split-bill/pay/{memberId}": {
            "post": {
                "tags": [
                    "Split Bill"
                ],
                "summary": "Pay a specific Split Bill member share",
                "operationId": "ce2ceb015f68d1308c910086c25c4cba",
                "parameters": [
                    {
                        "name": "memberId",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "pin"
                                ],
                                "properties": {
                                    "pin": {
                                        "type": "string",
                                        "example": "123456"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Payment successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Payment successful"
                                        },
                                        "current_balance": {
                                            "type": "number"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Invalid PIN"
                    },
                    "404": {
                        "description": "Bill not found"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/split-bill/created": {
            "get": {
                "tags": [
                    "Split Bill"
                ],
                "summary": "Get bills created by me",
                "operationId": "51f3d7ed693d6c0353dbd06d0ca82da7",
                "responses": {
                    "200": {
                        "description": "List of created bills",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/SplitBill"
                                    }
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/split-bill/incoming": {
            "get": {
                "tags": [
                    "Split Bill"
                ],
                "summary": "Get bills I need to pay",
                "operationId": "a5d604ad9699e50cce2a1d3720a49597",
                "responses": {
                    "200": {
                        "description": "List of incoming bills",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/SplitBillMember"
                                    }
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/topups": {
            "get": {
                "tags": [
                    "Topups"
                ],
                "summary": "List all topup requests (Admin)",
                "operationId": "df2152d32d0ebd292180325e013e4958",
                "responses": {
                    "200": {
                        "description": "List of topups",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/Topup"
                                    }
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            },
            "post": {
                "tags": [
                    "Topups"
                ],
                "summary": "Create a new topup (Admin/Gateway)",
                "operationId": "b2046184933ecb26817bf2936dc5e85c",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "user_id",
                                    "amount"
                                ],
                                "properties": {
                                    "user_id": {
                                        "type": "integer",
                                        "example": 1
                                    },
                                    "amount": {
                                        "type": "number",
                                        "example": 50000
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Topup successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Topup successful"
                                        },
                                        "current_balance": {
                                            "type": "number"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/topups/{id}": {
            "get": {
                "tags": [
                    "Topups"
                ],
                "summary": "Get topup details",
                "operationId": "9467fc90918d25dbd6aa463d3c4a6d04",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Topup details",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Topup"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Topup not found"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/transactions": {
            "get": {
                "tags": [
                    "Transactions"
                ],
                "summary": "List all transactions (Admin)",
                "operationId": "716a962b580bc03cf3aa45dc2ab6c0e2",
                "responses": {
                    "200": {
                        "description": "List of transactions",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/Transaction"
                                    }
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            },
            "post": {
                "tags": [
                    "Transactions"
                ],
                "summary": "Create a new payment transaction",
                "operationId": "238affdbe033b73010cbace3ad94520e",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "user_id",
                                    "amount",
                                    "description"
                                ],
                                "properties": {
                                    "user_id": {
                                        "type": "integer",
                                        "example": 1
                                    },
                                    "amount": {
                                        "type": "number",
                                        "example": 15000
                                    },
                                    "description": {
                                        "type": "string",
                                        "example": "Beli Nasi Goreng"
                                    },
                                    "category_id": {
                                        "type": "integer",
                                        "example": 2
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Payment successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Payment successful"
                                        },
                                        "transaction": {
                                            "$ref": "#/components/schemas/Transaction"
                                        },
                                        "current_balance": {
                                            "type": "number",
                                            "example": 35000
                                        },
                                        "points_earned": {
                                            "type": "integer",
                                            "example": 15
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Insufficient balance or validation error"
                    },
                    "404": {
                        "description": "User not found"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/history": {
            "get": {
                "tags": [
                    "Transactions"
                ],
                "summary": "Get authenticated user transaction history",
                "operationId": "3688d1698c27896038b253d006a06fd6",
                "responses": {
                    "200": {
                        "description": "User transaction history",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/Transaction"
                                    }
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/transactions/{id}": {
            "get": {
                "tags": [
                    "Transactions"
                ],
                "summary": "Get transaction details",
                "operationId": "2a6d0d9d6950359d14a92f71c3a55b6d",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Transaction details",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Transaction"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Transaction not found"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        },
        "/transfer": {
            "post": {
                "tags": [
                    "Transactions"
                ],
                "summary": "Transfer balance to another user",
                "operationId": "0670936002ac78e8461472cab670a411",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "recipient_email",
                                    "amount",
                                    "pin"
                                ],
                                "properties": {
                                    "recipient_email": {
                                        "type": "string",
                                        "format": "email",
                                        "example": "santri2@example.com"
                                    },
                                    "amount": {
                                        "type": "number",
                                        "example": 10000
                                    },
                                    "pin": {
                                        "type": "string",
                                        "example": "123456"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Transfer successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Transfer successful"
                                        },
                                        "current_balance": {
                                            "type": "number"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid data or insufficient balance"
                    },
                    "403": {
                        "description": "Invalid PIN"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                },
                "security": [
                    {
                        "sanctum": []
                    }
                ]
            }
        }
    },
    "components": {
        "schemas": {
            "Category": {
                "title": "Category",
                "description": "Category model schema",
                "properties": {
                    "id": {
                        "type": "integer",
                        "example": 1
                    },
                    "name": {
                        "type": "string",
                        "example": "Food"
                    },
                    "icon": {
                        "type": "string",
                        "example": "utensils"
                    }
                },
                "type": "object"
            },
            "Order": {
                "title": "Order",
                "description": "Order model schema",
                "properties": {
                    "id": {
                        "type": "integer",
                        "example": 1
                    },
                    "user_id": {
                        "type": "integer",
                        "example": 1
                    },
                    "merchant_id": {
                        "type": "integer",
                        "example": 1
                    },
                    "total_price": {
                        "type": "number",
                        "example": 45000
                    },
                    "status": {
                        "type": "string",
                        "example": "pending"
                    }
                },
                "type": "object"
            },
            "Product": {
                "title": "Product",
                "description": "Product model schema",
                "properties": {
                    "id": {
                        "type": "integer",
                        "example": 1
                    },
                    "merchant_id": {
                        "type": "integer",
                        "example": 1
                    },
                    "name": {
                        "type": "string",
                        "example": "Nasi Goreng"
                    },
                    "description": {
                        "type": "string",
                        "example": "Nasi goreng pedas sedap"
                    },
                    "price": {
                        "type": "number",
                        "example": 15000
                    },
                    "stock": {
                        "type": "integer",
                        "example": 50
                    }
                },
                "type": "object"
            },
            "SplitBill": {
                "title": "Split Bill",
                "description": "Split Bill model schema",
                "properties": {
                    "id": {
                        "type": "integer",
                        "example": 1
                    },
                    "owner_id": {
                        "type": "integer",
                        "example": 1
                    },
                    "total_amount": {
                        "type": "number",
                        "example": 60000
                    },
                    "description": {
                        "type": "string",
                        "example": "Dinner split"
                    },
                    "status": {
                        "type": "string",
                        "example": "pending"
                    }
                },
                "type": "object"
            },
            "SplitBillMember": {
                "title": "Split Bill Member",
                "description": "Split Bill Member model schema",
                "properties": {
                    "id": {
                        "type": "integer",
                        "example": 1
                    },
                    "split_bill_id": {
                        "type": "integer",
                        "example": 1
                    },
                    "user_id": {
                        "type": "integer",
                        "example": 2
                    },
                    "amount": {
                        "type": "number",
                        "example": 20000
                    },
                    "status": {
                        "type": "string",
                        "example": "pending"
                    }
                },
                "type": "object"
            },
            "Topup": {
                "title": "Topup",
                "description": "Topup model schema",
                "properties": {
                    "id": {
                        "type": "integer",
                        "example": 1
                    },
                    "user_id": {
                        "type": "integer",
                        "example": 1
                    },
                    "amount": {
                        "type": "number",
                        "example": 50000
                    },
                    "created_at": {
                        "type": "string",
                        "format": "date-time"
                    }
                },
                "type": "object"
            },
            "Transaction": {
                "title": "Transaction",
                "description": "Transaction model schema",
                "properties": {
                    "id": {
                        "type": "integer",
                        "example": 1
                    },
                    "user_id": {
                        "type": "integer",
                        "example": 1
                    },
                    "amount": {
                        "type": "number",
                        "format": "float",
                        "example": 15000
                    },
                    "description": {
                        "type": "string",
                        "example": "Beli Nasi Goreng"
                    },
                    "type": {
                        "type": "string",
                        "example": "payment"
                    },
                    "status": {
                        "type": "string",
                        "example": "success"
                    },
                    "recipient_id": {
                        "type": "integer",
                        "example": null,
                        "nullable": true
                    },
                    "category_id": {
                        "type": "integer",
                        "example": 2
                    },
                    "created_at": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "updated_at": {
                        "type": "string",
                        "format": "date-time"
                    }
                },
                "type": "object"
            },
            "User": {
                "title": "User",
                "description": "User model schema",
                "properties": {
                    "id": {
                        "type": "integer",
                        "example": 1
                    },
                    "name": {
                        "type": "string",
                        "example": "John Doe"
                    },
                    "email": {
                        "type": "string",
                        "format": "email",
                        "example": "john@example.com"
                    },
                    "role": {
                        "type": "string",
                        "example": "santri"
                    },
                    "balance": {
                        "type": "number",
                        "format": "float",
                        "example": 50000
                    },
                    "points": {
                        "type": "integer",
                        "example": 100
                    },
                    "tier": {
                        "type": "string",
                        "example": "Bronze"
                    },
                    "qr_code": {
                        "type": "string",
                        "example": "DP-ABC123XYZ"
                    }
                },
                "type": "object"
            }
        },
        "securitySchemes": {
            "sanctum": {
                "type": "http",
                "description": "Enter your Bearer token in the format: Bearer {token}",
                "bearerFormat": "JWT",
                "scheme": "bearer"
            }
        }
    },
    "tags": [
        {
            "name": "Authentication",
            "description": "Authentication"
        },
        {
            "name": "Merchant",
            "description": "Merchant"
        },
        {
            "name": "Split Bill",
            "description": "Split Bill"
        },
        {
            "name": "Topups",
            "description": "Topups"
        },
        {
            "name": "Transactions",
            "description": "Transactions"
        }
    ]
}